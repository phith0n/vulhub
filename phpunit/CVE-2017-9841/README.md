# phpunit Remote Code Execution Vulnerability (CVE-2017-9841)

Composer is a php package management tool. Using composer to install an extension will create a vendor folder in the current directory and put all the files in it. Usually this directory needs to be placed outside the web directory so that users cannot access it directly.

Phpunit is a unit testing tool in php. The `vendor/phpunit/phpunit/src/Util/PHP/eval-stdin.php` files of 4.8.19 ~ 4.8.27 and 5.0.10 ~ 5.6.2 have the following code. :

```php
Eval('?>'.file_get_contents('php://input'));
```

If the file is accessed directly by the user, it will cause a remote code execution vulnerability.

Reference link: http://phpunit.vulnbusters.com

## vulnerability environment

Execute the following command to start a php environment, where phpunit is installed in the web directory.

```
Docker-compose build
Docker-compose up -d
```

The web environment will start at `http://your-ip:8080`.

## Vulnerability recurrence

Send the PHP code directly as a POST Body to `http://your-ip:8080/vendor/phpunit/phpunit/src/Util/PHP/eval-stdin.php`:

![](1.png)