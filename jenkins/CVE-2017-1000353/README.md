# Jenkins-CI remote code execute exploit (CVE-2017-1000353)

[中文版本(Chinese version)](README.zh-cn.md)

## Reference Links

https://blogs.securiteam.com/index.php/archives/3171

## Vulnerability environment

Build and run：

```
docker-compose build
docker-compose up -d
```

We will be asked to setup initial password when first time run, and it will be stored at `/var/jenkins_home/secrets/initialAdminPassword`, use 

`docker-compose exec jenkins cat /var/jenkins_home/secrets/initialAdminPassword` to read it. 

This exploit can be triggered when use default settings, no need other tweaks.

## Exploit

### 1. Generate serialized string

The files we need to compile are under the payload folders.

 - Payload.java - the java source code of Payload
 - Payload.jar - the binary we built
 - *.jar - the dependency libraries
 - exploit.py - sending Payload to target

We can directly use the pre-built payload.jar, or you can build yourself.

Run the following commands to generate bytecode file

```bash
java -jar payload.jar jenkins_poc.ser "touch /tmp/success"
# jenkins_poc.ser is the bytecode we generated
# "touch ..." is the command to execute
```

### 2. Send bytecode and execute commands

Edit exploit.py according to your target ip and change FILE_SER to the bytecode file we just generated.

execute the command (tested with Python3):

![](1.png)

Enter the container, we can found the `/tmp/success` was created, which indicate that exploit is successful:

![](2.png)
